{% extends "base.html" %}

{% block content %}
    <!-- Note creation form container with animation -->
    <section class="2xl:w-1/3 mx-auto my-4 p-4 rounded-lg shadow-lg bg-white" style="animation-name: appear; animation-duration: 1s;">
        <h1 class="text-4xl text-center font-black py-10">Create Your Note</h1>

        <form method="post" id="note-form">
            <!-- CSRF token and hidden fields -->
            {{ form.hidden_tag() }}

            <!-- Title input -->
            <div class="w-3/4 mx-auto">
                {{ form.title(class="input-field", placeholder=form.title.label.text) }}
            </div>

            <!-- Hidden textarea to hold Quill HTML content -->
            {{ form.note(id="flask-form-note", style="display: none;") }}

            <!-- Quill rich text editor -->
            <div class="w-3/4 mx-auto my-7">
                <div id="note-creator" style="height: 300px;"></div>
            </div>

            <!-- Submit button aligned to the right -->
            <div class="flex items-center justify-end mt-6">
                {{ form.submit(class="submit-btn") }}
            </div>
        </form>
    </section>
    
    <!-- Quill editor JS -->
    <script src="{{ url_for('static', filename='quill/quill.js') }}"></script>
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>

    <script>
        // Initialize Quill editor with snow theme
        const quill = new Quill('#note-creator', {
        theme: 'snow',
        readOnly: false,
        modules: {
            toolbar: [
                [{ header: [1, 2, false] }],
                ['bold', 'italic', 'underline', 'strike'],
                ['link', 'blockquote', 'code-block', 'image'],
                [{ list: 'ordered' }, { list: 'bullet' }],
                ['clean']
            ]
        }});
            
        // Reference to form and hidden textarea
        const form = document.getElementById('note-form');
        const hiddenField = document.getElementById('flask-form-note');

        // On form submit, copy Quill editor HTML to hidden textarea
        form.addEventListener('submit', function (e) {
            hiddenField.value = quill.root.innerHTML;
        });
    </script>
{% endblock %}
