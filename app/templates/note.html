{% extends "base.html" %}

{% block head %}
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet" />
{% endblock %}

{% block content %}
    <div class="w-1/2 mx-auto rounded-lg shadow-lg text-center">{{note.title}}</div>
    <div class="max-w-4xl mx-auto my-14">
        <div id="quill-editor" class="rounded-lg shadow-lg" style="height: 600px;">{{note.text | safe}}</div>
    </div>

    {% if note.user_id == current_user.id %}
        <button onclick="edit()">Edit note</button>
        <form id="note-form" method="post">
            {{form.hidden_tag()}}
            {{form.note(id="flask-form-note", style="display: none;")}}

            {{form.submit(id="save-btn", class="bg-blue-500 text-white px-6 py-3 rounded hover:bg-blue-600 transition-colors", style="display: none;")}}
        </form>
    {% endif %}
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
    <script>
        let quill = new Quill('#quill-editor', {
        theme: 'bubble',
        readOnly: true
        });

        function edit() {
            quill = new Quill('#quill-editor', {
            theme: 'snow',
            readOnly: false
            });

            const saveBtn = document.getElementById('save-btn');
            saveBtn.style = "display:inline-block;"
        };

        const form = document.getElementById('note-form');
        const hiddenField = document.getElementById('flask-form-note');
        form.addEventListener('submit', function (e) {
            hiddenField.value = quill.root.innerHTML;
        });
    </script>
{% endblock %}
